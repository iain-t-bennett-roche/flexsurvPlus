<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting parametric survival models in R • flexsurvPlus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting parametric survival models in R">
<meta property="og:description" content="flexsurvPlus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsurvPlus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Fitting_models_in_R.html">Fitting parametric survival models in R</a>
    </li>
    <li>
      <a href="../articles/Fitting_models_in_R_bootstrap.html">PSA and correlated endpoints (bootstrap approch)</a>
    </li>
    <li>
      <a href="../articles/Survival_analysis_theory.html">Parametric survival analysis using the flexsurvPlus package: understanding the theory</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Fitting_models_in_R_files/header-attrs-2.6/header-attrs.js"></script><script src="Fitting_models_in_R_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting parametric survival models in R</h1>
                        <h4 class="author">Roche</h4>
            
            <h4 class="date">2021-01-06</h4>
      
      
      <div class="hidden name"><code>Fitting_models_in_R.Rmd</code></div>

    </div>

    
    
<style type="text/css">

body{ /* Normal  */
      font-size: 14px;
  }
td {  /* Table  */
  font-size: 10px;
}
h1.title {
  font-size: 38px;
}
h1 { /* Header 1 */
  font-size: 28px;
  }
h2 { /* Header 2 */
    font-size: 22px;
}
h3 { /* Header 3 */
  font-size: 18px;
}
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Parametric survival models are often the preferred method of extrapolating survival data for use in economic models. The National Institute for Health and Care Excellence (NICE) Decision Support Unit (DSU) technical support document (TSD) 14 recommends that the Exponential, Weibull, Gompertz, log-logistic, log normal and Generalized Gamma parametric models should all be considered.<span class="citation">[1]</span> More recently, NICE also discusses more flexible models in NICE DSU TSD 21, however, more these models are not in the scope of this package.<span class="citation">[2]</span> The Canadian Agency for Drugs and Technologies in Health (CADTH) additionally specifies that the Gamma distribution must also be considered. This document therefore details the characteristics of each of these distributions and demonstrates how the parameters from each distribution, outputted using the flexsurvPlus package, can be implemented within an economic model.<span class="citation">[3]</span></p>
<p>The flexsurvPlus package allows the inclusion of a treatment effect in the following three ways:</p>
<ul>
<li><p>Separate models - Models fitted to each treatment arm separately</p></li>
<li><p>Independent shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on both the scale and shape parameter(s) of the distribution.</p></li>
<li><p>Common shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on the scale parameter of the distribution. The shape parameter(s) of the distribution is common across treatments which reflects an assumption of proportional hazards or accelerated failure time between treatments depending on the distribution</p></li>
</ul>
<p>This document details how to use the <tt>flexsurvPlus</tt> package to perform these models. A separate vignette; “Parametric survival analysis using the flexsurvPlus package: understanding the theory” details the theory behind the models.</p>
</div>
<div id="set-up-packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#set-up-packages-and-data" class="anchor"></a>Set up packages and data</h1>
<div id="install-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#install-packages" class="anchor"></a>Install packages</h2>
<p>The following packages are required to run this example:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">flexsurvPlus</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tibble</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survival</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survminer</span>)
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Loading required package: ggpubr</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">boot</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'boot'</span>
<span class="co">#&gt; The following object is masked from 'package:survival':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     aml</span>


<span class="no">blue</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">69</span>, <span class="fl">185</span>, <span class="fl">209</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">red</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">225</span>, <span class="fl">55</span>, <span class="fl">60</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">yellow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">238</span>, <span class="fl">224</span>, <span class="fl">30</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">pink</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">211</span>,<span class="fl">78</span>,<span class="fl">147</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">Dblue</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0</span>,<span class="fl">45</span>,<span class="fl">92</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">Dyellow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">214</span>, <span class="fl">200</span>, <span class="fl">16</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">green</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>)
<span class="no">Dyellow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">214</span>, <span class="fl">200</span>, <span class="fl">16</span>, <span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">black</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">grey1</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">30</span>)
<span class="no">grey2</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">30</span>)
<span class="no">grey3</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">20</span>,<span class="fl">20</span>,<span class="fl">20</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">30</span>)
<span class="no">grey3_dup</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">20</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">30</span>)
<span class="no">lightPink</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">229</span>,<span class="fl">151</span>,<span class="fl">192</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)
<span class="no">orange</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">247</span>,<span class="fl">139</span>,<span class="fl">21</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">255</span>)</pre></body></html></div>
</div>
<div id="read-in-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#read-in-the-data" class="anchor"></a>Read in the data</h2>
<p>To perform survival analyses, patient level data is required for the survival endpoints.</p>
<p>This example uses a standard simulated data set (adtte). There is no standard naming that is needed for this package however, there are some set variables that are needed:</p>
<ul>
<li>Time - a numeric variable</li>
<li>Event - a binary variable (event=1, censor=0)</li>
<li>Treatment - a character variable with the name of the intervention treatment</li>
</ul>
<p>The data must be in “wide” format such that there is one row per patient and columns for each endpoint separately. In this example, we use progression-free survival (PFS).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">

<span class="no">adtte</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/sim_adtte.html">sim_adtte</a></span>(<span class="kw">seed</span> <span class="kw">=</span> <span class="fl">2020</span>, <span class="kw">rho</span> <span class="kw">=</span> <span class="fl">0.6</span>)

<span class="co"># subset PFS data and rename</span>
<span class="no">PFS_data</span> <span class="kw">&lt;-</span> <span class="no">adtte</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">PARAMCD</span><span class="kw">==</span><span class="st">"PFS"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span>(<span class="no">USUBJID</span>,
            <span class="no">ARMCD</span>,
            <span class="kw">PFS_days</span> <span class="kw">=</span> <span class="no">AVAL</span>,
            <span class="kw">PFS_event</span> <span class="kw">=</span> <span class="fl">1</span>- <span class="no">CNSR</span>
  )</pre></body></html></div>
</div>
</div>
<div id="exploratory-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#exploratory-analysis" class="anchor"></a>Exploratory analysis</h1>
<p>Before performing any statistical analysis, it is important to explore the data.</p>
<p>Most importantly is a Kaplan-Meier plot and code to do this using <tt>ggsurvplot</tt> is presented below.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">
<span class="no">km.est.PFS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">PFS_days</span>, <span class="no">PFS_event</span>) ~ <span class="no">ARMCD</span> , <span class="kw">data</span> <span class="kw">=</span> <span class="no">PFS_data</span>, <span class="kw">conf.type</span> <span class="kw">=</span> <span class="st">'plain'</span>)

<span class="co">#KM_list &lt;- list(OS = km.est.OS, PFS = km.est.PFS)</span>

<span class="no">KM_plot_PFS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span>(<span class="no">km.est.PFS</span>, <span class="kw">risk.table</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">PFS_data</span>,
           <span class="kw">break.time.by</span> <span class="kw">=</span> <span class="fl">200</span>,
           <span class="kw">conf.int</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
           <span class="kw">censor</span><span class="kw">=</span><span class="fl">FALSE</span>,
           <span class="kw">legend.title</span> <span class="kw">=</span> <span class="st">''</span>,
           <span class="kw">xlab</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">'Progression-free survival (Days)'</span>),
           <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.72</span>,
           <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">800</span>))
<span class="no">KM_plot_PFS</span></pre></body></html></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div id="fitting-the-models" class="section level1">
<h1 class="hasAnchor">
<a href="#fitting-the-models" class="anchor"></a>Fitting the models</h1>
<p>The <tt>runPSM</tt> function fits parametric survival models for multiple distributions using the <tt>flexsurv</tt> package (using the <tt>flexsurvPlus</tt> function <tt>fit_models</tt>), manipulates the flexsurv objects to get the parameter estimates and AIC and BIC value (using the <tt>flexsurvPlus</tt> function <tt>get_params</tt>) and rearranges the parameter estimates such that they can easily be output to excel to calculate survival for both the intervention and reference treatment in an economic model.</p>
<p>These functions can be used to estimate 3 types of model:</p>
<ul>
<li><p>Separate models - Models fitted to each treatment arm separately</p></li>
<li><p>Independent shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on both the scale and shape parameter(s) of the distribution.</p></li>
<li><p>Common shape models - Models fitted to both/all treatment arms including a treatment covariate to model the effect of treatment on the scale parameter of the distribution. The shape parameter(s) of the distribution is common across treatments which reflects an assumption of proportional hazards or accelerated failure time between treatments depending on the distribution</p></li>
</ul>
<p>Each type of model can be fitted with a multiple distributions. The distributions available for this package are: * Exponential (‘exp’) * Weibull (‘weibull’) * Gompertz (‘gompertz’) * Log-normal (‘lnorm’) * Log-logistic (‘llogis’) * Generalized gamma (‘gengamma’) * Gamma (‘gamma’)</p>
<p>For more information on the different types of models, please see the survival analysis theory vignette included in the <tt>flexsurvPlus</tt> package.</p>
<p>The inputs to the <tt>runPSM</tt> function are: <em><tt>data</tt> - A data frame containing individual patient data for the relevant time to event outcomes </em><tt>time_var</tt> - Name of time variable in ‘data’. Variable must be numerical and &gt;0. <em><tt>event_var</tt> - Name of event variable in ‘data’. Variable must be numerical and contain 1’s to indicate an event and 0 to indicate a censor. </em><tt>model.type</tt> - Character vector indicating the types of model formula provided. Permitted values are ‘Common shape’, ‘Independent shape’ or ‘Separate’ as per the models explained above. <em><tt>strata_var</tt> - Name of stratification variable in “data”. This is usually the treatment variable and must be categorical. </em><tt>int_name</tt> - Character to indicate the name of the treatment of interest, must be a level of the “strata_var” column in “data”, used for labelling the parameters. *<tt>ref_name </tt> - Character to indicate the name of the reference treatment, must be a level of the “strata_var” column in “data”, used for labelling the parameters.</p>
<p>More information about each function can be used by running the code ?runPSM.</p>
<p>Example code to fit all models is presented below.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">
<span class="no">psm_PFS_all</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/runPSM.html">runPSM</a></span>(<span class="kw">data</span><span class="kw">=</span><span class="no">PFS_data</span>,
                     <span class="kw">time_var</span><span class="kw">=</span><span class="st">"PFS_days"</span>,
                     <span class="kw">event_var</span><span class="kw">=</span><span class="st">"PFS_event"</span>,
                     <span class="kw">model.type</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Common shape"</span>,
                                   <span class="st">"Independent shape"</span>,
                                   <span class="st">"Separate"</span>),
                     <span class="kw">distr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'exp'</span>,
                               <span class="st">'weibull'</span>,
                               <span class="st">'gompertz'</span>,
                               <span class="st">'lnorm'</span>,
                               <span class="st">'llogis'</span>,
                               <span class="st">'gengamma'</span>,
                               <span class="st">'gamma'</span>),
                     <span class="kw">strata_var</span> <span class="kw">=</span> <span class="st">"ARMCD"</span>,
                     <span class="kw">int_name</span><span class="kw">=</span><span class="st">"A"</span>,
                     <span class="kw">ref_name</span> <span class="kw">=</span> <span class="st">"B"</span>)
<span class="no">psm_PFS_all</span>
<span class="co">#&gt; $models</span>
<span class="co">#&gt; $models$comshp.exp</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; rate          NA   0.002210  0.001911  0.002557  0.000164        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.767591  0.574293  0.960889  0.098623  2.154570  1.775875</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  2.614019</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2798.33, df = 2</span>
<span class="co">#&gt; AIC = 5600.66</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.weibull</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA     1.3881    1.2830    1.5017    0.0557        NA        NA</span>
<span class="co">#&gt; scale         NA   437.0600  393.4819  485.4643   23.4223        NA        NA</span>
<span class="co">#&gt; ARMInt    0.5000    -0.6623   -0.8035   -0.5211    0.0721    0.5157    0.4477</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; scale         NA</span>
<span class="co">#&gt; ARMInt    0.5939</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.611, df = 3</span>
<span class="co">#&gt; AIC = 5545.222</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.gompertz</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA   0.002072  0.001455  0.002688  0.000315        NA        NA</span>
<span class="co">#&gt; rate          NA   0.001358  0.001091  0.001690  0.000152        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.911755  0.712472  1.111039  0.101677  2.488687  2.039025</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  3.037512</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2779.001, df = 3</span>
<span class="co">#&gt; AIC = 5564.003</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.lnorm</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;          data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; meanlog       NA     5.7350   5.6068   5.8632   0.0654       NA        NA</span>
<span class="co">#&gt; sdlog         NA     0.9863   0.9199   1.0575   0.0351       NA        NA</span>
<span class="co">#&gt; ARMInt    0.5000    -0.7128  -0.8901  -0.5355   0.0905   0.4903    0.4106</span>
<span class="co">#&gt;          U95%   </span>
<span class="co">#&gt; meanlog       NA</span>
<span class="co">#&gt; sdlog         NA</span>
<span class="co">#&gt; ARMInt    0.5854</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2800.225, df = 3</span>
<span class="co">#&gt; AIC = 5606.451</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.llogis</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA     1.9062    1.7573    2.0676    0.0791        NA        NA</span>
<span class="co">#&gt; scale         NA   323.1928  288.2447  362.3782   18.8707        NA        NA</span>
<span class="co">#&gt; ARMInt    0.5000    -0.6975   -0.8565   -0.5384    0.0812    0.4978    0.4246</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; scale         NA</span>
<span class="co">#&gt; ARMInt    0.5837</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2780.256, df = 3</span>
<span class="co">#&gt; AIC = 5566.512</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.gengamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; mu           NA     6.0574   5.9291   6.1857   0.0654       NA        NA</span>
<span class="co">#&gt; sigma        NA     0.7377   0.6624   0.8215   0.0405       NA        NA</span>
<span class="co">#&gt; Q            NA     0.9195   0.6682   1.1708   0.1282       NA        NA</span>
<span class="co">#&gt; ARMInt   0.5000    -0.6699  -0.8149  -0.5249   0.0740   0.5118    0.4427</span>
<span class="co">#&gt;         U95%   </span>
<span class="co">#&gt; mu           NA</span>
<span class="co">#&gt; sigma        NA</span>
<span class="co">#&gt; Q            NA</span>
<span class="co">#&gt; ARMInt   0.5916</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.421, df = 4</span>
<span class="co">#&gt; AIC = 5546.841</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$comshp.gamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; shape         NA   1.658113  1.465091  1.876566  0.104702        NA        NA</span>
<span class="co">#&gt; rate          NA   0.004046  0.003377  0.004846  0.000373        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.684825  0.537124  0.832527  0.075359  1.983426  1.711078</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; shape         NA</span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  2.299122</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2770.102, df = 3</span>
<span class="co">#&gt; AIC = 5546.203</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.exp</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;       est       L95%      U95%      se      </span>
<span class="co">#&gt; rate  0.004762  0.004194  0.005408  0.000309</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1510.588, df = 1</span>
<span class="co">#&gt; AIC = 3023.176</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.weibull</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape    1.3841    1.2516    1.5306    0.0711</span>
<span class="co">#&gt; scale  225.2128  204.7892  247.6732   10.9235</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1493.471, df = 2</span>
<span class="co">#&gt; AIC = 2990.943</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.gompertz</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  0.002126  0.001252  0.003000  0.000446</span>
<span class="co">#&gt; rate   0.003345  0.002719  0.004116  0.000354</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1500.61, df = 2</span>
<span class="co">#&gt; AIC = 3005.22</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.lnorm</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;          est     L95%    U95%    se    </span>
<span class="co">#&gt; meanlog  5.0201  4.9049  5.1352  0.0587</span>
<span class="co">#&gt; sdlog    0.9245  0.8442  1.0124  0.0428</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1508.722, df = 2</span>
<span class="co">#&gt; AIC = 3021.443</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.llogis</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; shape    2.02    1.81    2.24    0.11</span>
<span class="co">#&gt; scale  161.22  145.05  179.19    8.69</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1499.366, df = 2</span>
<span class="co">#&gt; AIC = 3002.733</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.gengamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; mu     5.3572  5.2058  5.5086  0.0772</span>
<span class="co">#&gt; sigma  0.7496  0.6635  0.8469  0.0467</span>
<span class="co">#&gt; Q      0.8349  0.5197  1.1501  0.1608</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1492.975, df = 3</span>
<span class="co">#&gt; AIC = 2991.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.int.gamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  1.708525  1.447974  2.015960  0.144238</span>
<span class="co">#&gt; rate   0.008273  0.006806  0.010057  0.000824</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 238,  Censored: 12</span>
<span class="co">#&gt; Total time at risk: 49975</span>
<span class="co">#&gt; Log-likelihood = -1493.076, df = 2</span>
<span class="co">#&gt; AIC = 2990.152</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.exp</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;       est       L95%      U95%      se      </span>
<span class="co">#&gt; rate  0.002210  0.001911  0.002557  0.000164</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1287.742, df = 1</span>
<span class="co">#&gt; AIC = 2577.485</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.weibull</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape    1.3944    1.2290    1.5821    0.0898</span>
<span class="co">#&gt; scale  436.9567  393.5292  485.1766   23.3372</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1276.135, df = 2</span>
<span class="co">#&gt; AIC = 2556.271</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.gompertz</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  0.002018  0.001149  0.002887  0.000443</span>
<span class="co">#&gt; rate   0.001377  0.001050  0.001807  0.000191</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1278.377, df = 2</span>
<span class="co">#&gt; AIC = 2560.755</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.lnorm</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;          est     L95%    U95%    se    </span>
<span class="co">#&gt; meanlog  5.7541  5.6135  5.8946  0.0717</span>
<span class="co">#&gt; sdlog    1.0684  0.9587  1.1907  0.0591</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1289.469, df = 2</span>
<span class="co">#&gt; AIC = 2582.939</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.llogis</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est      L95%     U95%     se     </span>
<span class="co">#&gt; shape    1.775    1.566    2.012    0.113</span>
<span class="co">#&gt; scale  324.711  287.502  366.736   20.163</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1279.735, df = 2</span>
<span class="co">#&gt; AIC = 2563.469</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.gengamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est     L95%    U95%    se    </span>
<span class="co">#&gt; mu     6.1015  5.9352  6.2679  0.0849</span>
<span class="co">#&gt; sigma  0.6938  0.5462  0.8814  0.0847</span>
<span class="co">#&gt; Q      1.0810  0.5839  1.5782  0.2537</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1276.081, df = 3</span>
<span class="co">#&gt; AIC = 2558.162</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$sep.ref.gamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;        est       L95%      U95%      se      </span>
<span class="co">#&gt; shape  1.596692  1.325325  1.923622  0.151750</span>
<span class="co">#&gt; rate   0.003872  0.003033  0.004943  0.000482</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 250,  Events: 181,  Censored: 69</span>
<span class="co">#&gt; Total time at risk: 81887</span>
<span class="co">#&gt; Log-likelihood = -1276.884, df = 2</span>
<span class="co">#&gt; AIC = 2557.768</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.exp</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;         data mean  est       L95%      U95%      se        exp(est)  L95%    </span>
<span class="co">#&gt; rate          NA   0.002210  0.001911  0.002557  0.000164        NA        NA</span>
<span class="co">#&gt; ARMInt  0.500000   0.767591  0.574293  0.960889  0.098623  2.154570  1.775875</span>
<span class="co">#&gt;         U95%    </span>
<span class="co">#&gt; rate          NA</span>
<span class="co">#&gt; ARMInt  2.614019</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2798.33, df = 2</span>
<span class="co">#&gt; AIC = 5600.66</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.weibull</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est        L95%       U95%       se         exp(est) </span>
<span class="co">#&gt; shape                 NA    1.39439    1.22897    1.58208    0.08984         NA</span>
<span class="co">#&gt; scale                 NA  436.95667  393.52916  485.17658   23.33723         NA</span>
<span class="co">#&gt; ARMInt           0.50000   -0.66279   -0.80419   -0.52138    0.07215    0.51541</span>
<span class="co">#&gt; shape(ARMInt)    0.50000   -0.00742   -0.16889    0.15406    0.08239    0.99261</span>
<span class="co">#&gt;                L95%       U95%     </span>
<span class="co">#&gt; shape                 NA         NA</span>
<span class="co">#&gt; scale                 NA         NA</span>
<span class="co">#&gt; ARMInt           0.44745    0.59370</span>
<span class="co">#&gt; shape(ARMInt)    0.84460    1.16656</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.607, df = 4</span>
<span class="co">#&gt; AIC = 5547.214</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.gompertz</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est        L95%       U95%       se         exp(est) </span>
<span class="co">#&gt; shape                 NA   0.002018   0.001148   0.002887   0.000443         NA</span>
<span class="co">#&gt; rate                  NA   0.001377   0.001050   0.001807   0.000191         NA</span>
<span class="co">#&gt; ARMInt          0.500000   0.887593   0.545992   1.229194   0.174289   2.429276</span>
<span class="co">#&gt; shape(ARMInt)   0.500000   0.000108  -0.001124   0.001341   0.000629   1.000108</span>
<span class="co">#&gt;                L95%       U95%     </span>
<span class="co">#&gt; shape                 NA         NA</span>
<span class="co">#&gt; rate                  NA         NA</span>
<span class="co">#&gt; ARMInt          1.726320   3.418474</span>
<span class="co">#&gt; shape(ARMInt)   0.998877   1.001342</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2778.987, df = 4</span>
<span class="co">#&gt; AIC = 5565.974</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.llogis</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est       L95%      U95%      se        exp(est)</span>
<span class="co">#&gt; shape                NA     1.7752    1.5662    2.0121    0.1134        NA</span>
<span class="co">#&gt; scale                NA   324.7128  287.5038  366.7375   20.1633        NA</span>
<span class="co">#&gt; ARMInt           0.5000    -0.7002   -0.8614   -0.5390    0.0822    0.4965</span>
<span class="co">#&gt; shape(ARMInt)    0.5000     0.1272   -0.0375    0.2919    0.0840    1.1357</span>
<span class="co">#&gt;                L95%      U95%    </span>
<span class="co">#&gt; shape                NA        NA</span>
<span class="co">#&gt; scale                NA        NA</span>
<span class="co">#&gt; ARMInt           0.4226    0.5833</span>
<span class="co">#&gt; shape(ARMInt)    0.9632    1.3390</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2779.101, df = 4</span>
<span class="co">#&gt; AIC = 5566.202</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.gamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est        L95%       U95%       se         exp(est) </span>
<span class="co">#&gt; shape                 NA   1.596555   1.325203   1.923470   0.151743         NA</span>
<span class="co">#&gt; rate                  NA   0.003871   0.003032   0.004942   0.000482         NA</span>
<span class="co">#&gt; ARMInt          0.500000   0.759334   0.446665   1.072003   0.159528   2.136853</span>
<span class="co">#&gt; shape(ARMInt)   0.500000   0.067700  -0.181462   0.316863   0.127126   1.070045</span>
<span class="co">#&gt;                L95%       U95%     </span>
<span class="co">#&gt; shape                 NA         NA</span>
<span class="co">#&gt; rate                  NA         NA</span>
<span class="co">#&gt; ARMInt          1.563091   2.921226</span>
<span class="co">#&gt; shape(ARMInt)   0.834050   1.372814</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.96, df = 4</span>
<span class="co">#&gt; AIC = 5547.919</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.lnorm</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est       L95%      U95%      se        exp(est)</span>
<span class="co">#&gt; meanlog              NA    5.75408   5.61352   5.89464   0.07172        NA</span>
<span class="co">#&gt; sdlog                NA    1.06842   0.95866   1.19074   0.05909        NA</span>
<span class="co">#&gt; ARMInt          0.50000   -0.73401  -0.91570  -0.55232   0.09270   0.47998</span>
<span class="co">#&gt; sdlog(ARMInt)   0.50000   -0.14466  -0.28608  -0.00323   0.07216   0.86532</span>
<span class="co">#&gt;                L95%      U95%    </span>
<span class="co">#&gt; meanlog              NA        NA</span>
<span class="co">#&gt; sdlog                NA        NA</span>
<span class="co">#&gt; ARMInt          0.40024   0.57561</span>
<span class="co">#&gt; sdlog(ARMInt)   0.75120   0.99678</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2798.191, df = 4</span>
<span class="co">#&gt; AIC = 5604.382</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $models$indshp.gengamma</span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; flexsurv::flexsurvreg(formula = model.formula, data = data, dist = dist)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates: </span>
<span class="co">#&gt;                data mean  est      L95%     U95%     se       exp(est)  L95%   </span>
<span class="co">#&gt; mu                  NA     6.1016   5.9352   6.2680   0.0849       NA        NA</span>
<span class="co">#&gt; sigma               NA     0.6938   0.5461   0.8814   0.0847       NA        NA</span>
<span class="co">#&gt; Q                   NA     1.0814   0.5840   1.5788   0.2538       NA        NA</span>
<span class="co">#&gt; ARMInt          0.5000    -0.7444  -0.9693  -0.5194   0.1148   0.4750    0.3794</span>
<span class="co">#&gt; sigma(ARMInt)   0.5000     0.0773  -0.1913   0.3460   0.1371   1.0804    0.8258</span>
<span class="co">#&gt; Q(ARMInt)       0.5000    -0.2465  -0.8353   0.3423   0.3004   0.7816    0.4338</span>
<span class="co">#&gt;                U95%   </span>
<span class="co">#&gt; mu                  NA</span>
<span class="co">#&gt; sigma               NA</span>
<span class="co">#&gt; Q                   NA</span>
<span class="co">#&gt; ARMInt          0.5949</span>
<span class="co">#&gt; sigma(ARMInt)   1.4134</span>
<span class="co">#&gt; Q(ARMInt)       1.4082</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; N = 500,  Events: 419,  Censored: 81</span>
<span class="co">#&gt; Total time at risk: 131862</span>
<span class="co">#&gt; Log-likelihood = -2769.056, df = 6</span>
<span class="co">#&gt; AIC = 5550.112</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model_summary</span>
<span class="co">#&gt; # A tibble: 28 x 5</span>
<span class="co">#&gt;    name             value      coef           AIC   BIC</span>
<span class="co">#&gt;    &lt;chr&gt;            &lt;list&gt;     &lt;named list&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 comshp.exp       &lt;flxsrvrg&gt; &lt;dbl [2]&gt;    5601. 5609.</span>
<span class="co">#&gt;  2 comshp.weibull   &lt;flxsrvrg&gt; &lt;dbl [3]&gt;    5545. 5558.</span>
<span class="co">#&gt;  3 comshp.gompertz  &lt;flxsrvrg&gt; &lt;dbl [3]&gt;    5564. 5577.</span>
<span class="co">#&gt;  4 comshp.lnorm     &lt;flxsrvrg&gt; &lt;dbl [3]&gt;    5606. 5619.</span>
<span class="co">#&gt;  5 comshp.llogis    &lt;flxsrvrg&gt; &lt;dbl [3]&gt;    5567. 5579.</span>
<span class="co">#&gt;  6 comshp.gengamma  &lt;flxsrvrg&gt; &lt;dbl [4]&gt;    5547. 5564.</span>
<span class="co">#&gt;  7 comshp.gamma     &lt;flxsrvrg&gt; &lt;dbl [3]&gt;    5546. 5559.</span>
<span class="co">#&gt;  8 sep.int.exp      &lt;flxsrvrg&gt; &lt;dbl [1]&gt;    3023. 3027.</span>
<span class="co">#&gt;  9 sep.int.weibull  &lt;flxsrvrg&gt; &lt;dbl [2]&gt;    2991. 2998.</span>
<span class="co">#&gt; 10 sep.int.gompertz &lt;flxsrvrg&gt; &lt;dbl [2]&gt;    3005. 3012.</span>
<span class="co">#&gt; # … with 18 more rows</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameters</span>
<span class="co">#&gt;   exp.rate.int exp.rate.ref exp.rate.TE weibull.scale.int weibull.scale.ref</span>
<span class="co">#&gt; 1  0.004762381  0.002210363    0.767591          225.3719          437.0600</span>
<span class="co">#&gt; 2  0.004762381  0.002210363          NA          225.2128          436.9567</span>
<span class="co">#&gt; 3  0.004762381  0.002210363    0.767591          225.2128          436.9567</span>
<span class="co">#&gt;   weibull.shape.int weibull.shape.ref weibull.scale.TE gompertz.rate.int</span>
<span class="co">#&gt; 1           1.38807          1.388070       -0.6623183       0.003378992</span>
<span class="co">#&gt; 2           1.38409          1.394392               NA       0.003345261</span>
<span class="co">#&gt; 3           1.38409          1.394392       -0.6627884       0.003345363</span>
<span class="co">#&gt;   gompertz.rate.ref gompertz.shape.int gompertz.shape.ref gompertz.rate.TE</span>
<span class="co">#&gt; 1       0.001357741        0.002071791        0.002071791        0.9117552</span>
<span class="co">#&gt; 2       0.001377019        0.002126025        0.002017723               NA</span>
<span class="co">#&gt; 3       0.001377103        0.002125949        0.002017541        0.8875933</span>
<span class="co">#&gt;   llogis.scale.int llogis.scale.ref llogis.shape.int llogis.shape.ref</span>
<span class="co">#&gt; 1         160.9001         323.1928         1.906172         1.906172</span>
<span class="co">#&gt; 2         161.2189         324.7112         2.016085         1.775194</span>
<span class="co">#&gt; 3         161.2182         324.7128         2.016077         1.775211</span>
<span class="co">#&gt;   llogis.scale.TE gamma.rate.int gamma.rate.ref gamma.shape.int gamma.shape.ref</span>
<span class="co">#&gt; 1      -0.6974655    0.008024506    0.004045781        1.658113        1.658113</span>
<span class="co">#&gt; 2              NA    0.008273127    0.003871635        1.708525        1.596692</span>
<span class="co">#&gt; 3      -0.7001824    0.008272142    0.003871179        1.708385        1.596555</span>
<span class="co">#&gt;   gamma.rate.TE lnorm.meanlog.int lnorm.meanlog.ref lnorm.sdlog.int</span>
<span class="co">#&gt; 1     0.6848254          5.022173          5.734996       0.9862778</span>
<span class="co">#&gt; 2            NA          5.020074          5.754086       0.9245221</span>
<span class="co">#&gt; 3     0.7593344          5.020074          5.754082       0.9245219</span>
<span class="co">#&gt;   lnorm.sdlog.ref lnorm.meanlog.TE gengamma.mu.int gengamma.mu.ref</span>
<span class="co">#&gt; 1       0.9862778        -0.712823        5.387505        6.057406</span>
<span class="co">#&gt; 2       1.0684160               NA        5.357216        6.101537</span>
<span class="co">#&gt; 3       1.0684160        -0.734008        5.357237        6.101598</span>
<span class="co">#&gt;   gengamma.sigma.int gengamma.sigma.ref gengamma.Q.int gengamma.Q.ref</span>
<span class="co">#&gt; 1          0.7376519          0.7376519      0.9194986      0.9194986</span>
<span class="co">#&gt; 2          0.7495726          0.6938119      0.8349065      1.0810414</span>
<span class="co">#&gt; 3          0.7495580          0.6937829      0.8349304      1.0813996</span>
<span class="co">#&gt;   gengamma.mu.TE             Model Intervention_name Reference_name</span>
<span class="co">#&gt; 1     -0.6699007      Common shape                 A              B</span>
<span class="co">#&gt; 2             NA          Seperate                 A              B</span>
<span class="co">#&gt; 3     -0.7443610 Independent shape                 A              B</span>
<span class="co">#&gt;   weibull.shape.TE gompertz.shape.TE llogis.shape.TE gamma.shape.TE</span>
<span class="co">#&gt; 1               NA                NA              NA             NA</span>
<span class="co">#&gt; 2               NA                NA              NA             NA</span>
<span class="co">#&gt; 3     -0.007415373      0.0001084078        0.127234      0.0677004</span>
<span class="co">#&gt;   lnorm.sdlog.TE gengamma.sigma.TE gengamma.Q.TE</span>
<span class="co">#&gt; 1             NA                NA            NA</span>
<span class="co">#&gt; 2             NA                NA            NA</span>
<span class="co">#&gt; 3     -0.1446557        0.07732464    -0.2464692</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $parameters_vector</span>
<span class="co">#&gt;       comshp.exp.rate.int       comshp.exp.rate.ref        comshp.exp.rate.TE </span>
<span class="co">#&gt;              4.762381e-03              2.210363e-03              7.675910e-01 </span>
<span class="co">#&gt;  comshp.weibull.scale.int  comshp.weibull.scale.ref  comshp.weibull.shape.int </span>
<span class="co">#&gt;              2.253719e+02              4.370600e+02              1.388070e+00 </span>
<span class="co">#&gt;  comshp.weibull.shape.ref   comshp.weibull.scale.TE  comshp.gompertz.rate.int </span>
<span class="co">#&gt;              1.388070e+00             -6.623183e-01              3.378992e-03 </span>
<span class="co">#&gt;  comshp.gompertz.rate.ref comshp.gompertz.shape.int comshp.gompertz.shape.ref </span>
<span class="co">#&gt;              1.357741e-03              2.071791e-03              2.071791e-03 </span>
<span class="co">#&gt;   comshp.gompertz.rate.TE   comshp.llogis.scale.int   comshp.llogis.scale.ref </span>
<span class="co">#&gt;              9.117552e-01              1.609001e+02              3.231928e+02 </span>
<span class="co">#&gt;   comshp.llogis.shape.int   comshp.llogis.shape.ref    comshp.llogis.scale.TE </span>
<span class="co">#&gt;              1.906172e+00              1.906172e+00             -6.974655e-01 </span>
<span class="co">#&gt;     comshp.gamma.rate.int     comshp.gamma.rate.ref    comshp.gamma.shape.int </span>
<span class="co">#&gt;              8.024506e-03              4.045781e-03              1.658113e+00 </span>
<span class="co">#&gt;    comshp.gamma.shape.ref      comshp.gamma.rate.TE  comshp.lnorm.meanlog.int </span>
<span class="co">#&gt;              1.658113e+00              6.848254e-01              5.022173e+00 </span>
<span class="co">#&gt;  comshp.lnorm.meanlog.ref    comshp.lnorm.sdlog.int    comshp.lnorm.sdlog.ref </span>
<span class="co">#&gt;              5.734996e+00              9.862778e-01              9.862778e-01 </span>
<span class="co">#&gt;   comshp.lnorm.meanlog.TE    comshp.gengamma.mu.int    comshp.gengamma.mu.ref </span>
<span class="co">#&gt;             -7.128230e-01              5.387505e+00              6.057406e+00 </span>
<span class="co">#&gt; comshp.gengamma.sigma.int comshp.gengamma.sigma.ref     comshp.gengamma.Q.int </span>
<span class="co">#&gt;              7.376519e-01              7.376519e-01              9.194986e-01 </span>
<span class="co">#&gt;     comshp.gengamma.Q.ref     comshp.gengamma.mu.TE          sep.exp.rate.int </span>
<span class="co">#&gt;              9.194986e-01             -6.699007e-01              4.762381e-03 </span>
<span class="co">#&gt;     sep.weibull.shape.int     sep.weibull.scale.int    sep.gompertz.shape.int </span>
<span class="co">#&gt;              1.384090e+00              2.252128e+02              2.126025e-03 </span>
<span class="co">#&gt;     sep.gompertz.rate.int     sep.lnorm.meanlog.int       sep.lnorm.sdlog.int </span>
<span class="co">#&gt;              3.345261e-03              5.020074e+00              9.245221e-01 </span>
<span class="co">#&gt;      sep.llogis.shape.int      sep.llogis.scale.int       sep.gengamma.mu.int </span>
<span class="co">#&gt;              2.016085e+00              1.612189e+02              5.357216e+00 </span>
<span class="co">#&gt;    sep.gengamma.sigma.int        sep.gengamma.Q.int       sep.gamma.shape.int </span>
<span class="co">#&gt;              7.495726e-01              8.349065e-01              1.708525e+00 </span>
<span class="co">#&gt;        sep.gamma.rate.int          sep.exp.rate.ref     sep.weibull.shape.ref </span>
<span class="co">#&gt;              8.273127e-03              2.210363e-03              1.394392e+00 </span>
<span class="co">#&gt;     sep.weibull.scale.ref    sep.gompertz.shape.ref     sep.gompertz.rate.ref </span>
<span class="co">#&gt;              4.369567e+02              2.017723e-03              1.377019e-03 </span>
<span class="co">#&gt;     sep.lnorm.meanlog.ref       sep.lnorm.sdlog.ref      sep.llogis.shape.ref </span>
<span class="co">#&gt;              5.754086e+00              1.068416e+00              1.775194e+00 </span>
<span class="co">#&gt;      sep.llogis.scale.ref       sep.gengamma.mu.ref    sep.gengamma.sigma.ref </span>
<span class="co">#&gt;              3.247112e+02              6.101537e+00              6.938119e-01 </span>
<span class="co">#&gt;        sep.gengamma.Q.ref       sep.gamma.shape.ref        sep.gamma.rate.ref </span>
<span class="co">#&gt;              1.081041e+00              1.596692e+00              3.871635e-03 </span>
<span class="co">#&gt;       indshp.exp.rate.int       indshp.exp.rate.ref        indshp.exp.rate.TE </span>
<span class="co">#&gt;              4.762381e-03              2.210363e-03              7.675910e-01 </span>
<span class="co">#&gt;  indshp.weibull.scale.int  indshp.weibull.scale.ref  indshp.weibull.shape.int </span>
<span class="co">#&gt;              2.252128e+02              4.369567e+02              1.384090e+00 </span>
<span class="co">#&gt;  indshp.weibull.shape.ref   indshp.weibull.scale.TE   indshp.weibull.shape.TE </span>
<span class="co">#&gt;              1.394392e+00             -6.627884e-01             -7.415373e-03 </span>
<span class="co">#&gt;  indshp.gompertz.rate.int  indshp.gompertz.rate.ref indshp.gompertz.shape.int </span>
<span class="co">#&gt;              3.345363e-03              1.377103e-03              2.125949e-03 </span>
<span class="co">#&gt; indshp.gompertz.shape.ref   indshp.gompertz.rate.TE  indshp.gompertz.shape.TE </span>
<span class="co">#&gt;              2.017541e-03              8.875933e-01              1.084078e-04 </span>
<span class="co">#&gt;   indshp.llogis.scale.int   indshp.llogis.scale.ref   indshp.llogis.shape.int </span>
<span class="co">#&gt;              1.612182e+02              3.247128e+02              2.016077e+00 </span>
<span class="co">#&gt;   indshp.llogis.shape.ref    indshp.llogis.scale.TE    indshp.llogis.shape.TE </span>
<span class="co">#&gt;              1.775211e+00             -7.001824e-01              1.272340e-01 </span>
<span class="co">#&gt;     indshp.gamma.rate.int     indshp.gamma.rate.ref    indshp.gamma.shape.int </span>
<span class="co">#&gt;              8.272142e-03              3.871179e-03              1.708385e+00 </span>
<span class="co">#&gt;    indshp.gamma.shape.ref      indshp.gamma.rate.TE     indshp.gamma.shape.TE </span>
<span class="co">#&gt;              1.596555e+00              7.593344e-01              6.770040e-02 </span>
<span class="co">#&gt;  indshp.lnorm.meanlog.int  indshp.lnorm.meanlog.ref    indshp.lnorm.sdlog.int </span>
<span class="co">#&gt;              5.020074e+00              5.754082e+00              9.245219e-01 </span>
<span class="co">#&gt;    indshp.lnorm.sdlog.ref   indshp.lnorm.meanlog.TE     indshp.lnorm.sdlog.TE </span>
<span class="co">#&gt;              1.068416e+00             -7.340080e-01             -1.446557e-01 </span>
<span class="co">#&gt;    indshp.gengamma.mu.int    indshp.gengamma.mu.ref indshp.gengamma.sigma.int </span>
<span class="co">#&gt;              5.357237e+00              6.101598e+00              7.495580e-01 </span>
<span class="co">#&gt; indshp.gengamma.sigma.ref     indshp.gengamma.Q.int     indshp.gengamma.Q.ref </span>
<span class="co">#&gt;              6.937829e-01              8.349304e-01              1.081400e+00 </span>
<span class="co">#&gt;     indshp.gengamma.mu.TE  indshp.gengamma.sigma.TE      indshp.gengamma.Q.TE </span>
<span class="co">#&gt;             -7.443610e-01              7.732464e-02             -2.464692e-01</span></pre></body></html></div>
<div id="separate-models-for-each-treatment" class="section level2">
<h2 class="hasAnchor">
<a href="#separate-models-for-each-treatment" class="anchor"></a>Separate models for each treatment</h2>
<p>These models have been fit using the <tt>runPSM</tt> function using the model.type=“Separate” argument.</p>
</div>
<div id="independent-shape-models" class="section level2">
<h2 class="hasAnchor">
<a href="#independent-shape-models" class="anchor"></a>Independent shape models</h2>
<p>These models are similar to the separate model for each treatment as they allow all parameters to vary by treatment, however it is performed using 1 model for 2 treatments, rather than 2 models as above. They have been fit using the <tt>runPSM</tt> function using the model.type=“Independent shape” argument.</p>
</div>
<div id="fit-common-shape-models" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-common-shape-models" class="anchor"></a>Fit common shape models</h2>
<p>These models have been fit using the <tt>runPSM</tt> function using the model.type=“Common shape” argument.</p>
</div>
</div>
<div id="estimate-survival-from-the-models-and-plot-the-curves" class="section level1">
<h1 class="hasAnchor">
<a href="#estimate-survival-from-the-models-and-plot-the-curves" class="anchor"></a>Estimate survival from the models and plot the curves</h1>
<p>Survival at a given time can be estimated using the <tt>get_curvefits</tt> function as shown below for treatment-effect models.</p>
<p>This can be used to cross check survival in excel models. The example is given below selects only a few models for clarity.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># Landmark survival</span>

<span class="co"># for clarity just pick the 4 different weibull models. </span>
<span class="no">selected_models</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"comshp.weibull"</span>,<span class="st">"indshp.weibull"</span>,<span class="st">"sepint.weibull"</span>, <span class="st">"sepref.weibull"</span>)

<span class="no">curvefits_PFS_landmark</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_curvefits.html">get_curvefits</a></span>(<span class="kw">models</span> <span class="kw">=</span> <span class="no">psm_PFS_all</span>$<span class="no">models</span>[<span class="no">selected_models</span>],
                                           <span class="kw">time</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span>))
<span class="no">curvefits_df_PFS_landmark</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(<span class="no">curvefits_PFS_landmark</span>$<span class="no">curvefits</span>, <span class="kw">.id</span> <span class="kw">=</span> <span class="st">"Dist"</span>)  <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span>(<span class="kw">names_from</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">Dist</span>, <span class="no">ARM</span>), <span class="kw">values_from</span>  <span class="kw">=</span> <span class="no">est</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>()
<span class="no">curvefits_df_PFS_landmark</span>
<span class="co">#&gt;   time Length Class Mode     1_Int     1_Ref     2_Int     2_Ref 3_NA 4_NA</span>
<span class="co">#&gt; 1    0   &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; 1.0000000 1.0000000 1.0000000 1.0000000   NA   NA</span>
<span class="co">#&gt; 2  100   &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; 0.7234631 0.8788970 0.7224754 0.8799136   NA   NA</span>
<span class="co">#&gt; 3  200   &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; 0.4286008 0.7132961 0.4280730 0.7144061   NA   NA</span>
<span class="co">#&gt; 4  300   &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt; 0.2259593 0.5525858 0.2260132 0.5532573   NA   NA</span>
<span class="co">#&gt; 5   NA      0  NULL NULL        NA        NA        NA        NA   NA   NA</span></pre></body></html></div>
<p>The <tt>get_curvefits</tt> function can also be used to generate the data required to plot the survival curves, overlaid on top of the KM plot. The time argument should reflect how long you want to the extrapolate for and the unit of time is the same as the input data (in this example, days).</p>
<p>The <tt>ggsurvplot</tt> function from the <tt>survminer</tt> package has been used to show how the survival curves can be plotted.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">
<span class="co"># for clarity just pick the 2 different weibull models and a Gamma. </span>
<span class="no">selected_models</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"comshp.weibull"</span>,<span class="st">"comshp.gengamma"</span>,<span class="st">"indshp.gengamma"</span>)

<span class="co"># Create data set for plots</span>
<span class="no">curvefits_PFS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_curvefits.html">get_curvefits</a></span>(<span class="kw">models</span> <span class="kw">=</span> <span class="no">psm_PFS_all</span>$<span class="no">models</span>[<span class="no">selected_models</span>],
                                  <span class="kw">time</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span><span class="kw">=</span><span class="fl">0</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fl">500</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fl">10</span>))

<span class="co"># format data ready for the plot</span>
<span class="no">curvefits_df_PFS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(<span class="no">curvefits_PFS</span>$<span class="no">curvefits</span>, <span class="kw">.id</span> <span class="kw">=</span> <span class="st">"Dist"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span>(<span class="kw">names_from</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">ARM</span>), <span class="kw">values_from</span>  <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">est</span>))

<span class="no">analysis_data_TrtA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">PFS_data</span>, <span class="no">ARMCD</span><span class="kw">==</span><span class="st">"A"</span>)
<span class="no">analysis_data_TrtB</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">PFS_data</span>, <span class="no">ARMCD</span><span class="kw">==</span><span class="st">"B"</span>)

<span class="co"># Get KM estimates</span>
<span class="no">km.est.PFS.TrtA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">PFS_days</span>, <span class="no">PFS_event</span>) ~ <span class="fl">1</span> , <span class="kw">data</span> <span class="kw">=</span> <span class="no">analysis_data_TrtA</span>, <span class="kw">conf.type</span> <span class="kw">=</span> <span class="st">'plain'</span>)
<span class="no">km.est.PFS.TrtB</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">PFS_days</span>, <span class="no">PFS_event</span>) ~ <span class="fl">1</span> , <span class="kw">data</span> <span class="kw">=</span> <span class="no">analysis_data_TrtB</span>, <span class="kw">conf.type</span> <span class="kw">=</span> <span class="st">'plain'</span>)


<span class="co"># Plot survival curves for arm A</span>
<span class="no">plot.PFS.A</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span>(<span class="no">km.est.PFS.TrtA</span>,
                        <span class="kw">combine</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                        <span class="kw">censor</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                        <span class="kw">risk.table</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                        <span class="kw">conf.int</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                        <span class="kw">break.x.by</span> <span class="kw">=</span> <span class="fl">100</span>,
                        <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">500</span>),
                        <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Time (days)"</span>,
                        <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.72</span>,
                        <span class="kw">linetype</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>),
                        <span class="kw">title</span>  <span class="kw">=</span>  <span class="st">'Kaplan-Meier of OS with standard distribution overlays'</span>,
                        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="st">''</span>,
                        <span class="kw">legend.labs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"KM"</span>),
                        <span class="kw">surv.median.line</span> <span class="kw">=</span> <span class="st">'hv'</span>,
                        <span class="kw">palette</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">30</span>)),
                        <span class="kw">risk.table.y.text.col</span> <span class="kw">=</span> <span class="no">F</span>
)


<span class="no">plot.PFS.A</span>$<span class="no">plot</span> <span class="kw">&lt;-</span> <span class="no">plot.PFS.A</span>$<span class="no">plot</span> +
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">time</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">Int</span>,
                <span class="kw">colour</span> <span class="kw">=</span> <span class="no">Dist</span>,
                <span class="kw">linetype</span> <span class="kw">=</span> <span class="no">Dist</span>),
            <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.72</span>,
            <span class="kw">data</span> <span class="kw">=</span> <span class="no">curvefits_df_PFS</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">blue</span>, <span class="no">pink</span>, <span class="no">Dyellow</span>, <span class="no">orange</span>))
<span class="co">#&gt; Scale for 'colour' is already present. Adding another scale for 'colour',</span>
<span class="co">#&gt; which will replace the existing scale.</span>

<span class="no">plot.PFS.A</span></pre></body></html></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><html><body><pre class="r">
<span class="co"># Plot survival curves for arm B</span>
<span class="no">plot.PFS.B</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span>(<span class="no">km.est.PFS.TrtB</span>,
                        <span class="kw">combine</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                        <span class="kw">censor</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                        <span class="kw">risk.table</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                        <span class="kw">conf.int</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                        <span class="kw">break.x.by</span> <span class="kw">=</span> <span class="fl">100</span>,
                        <span class="kw">xlim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">500</span>),
                        <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Time (days)"</span>,
                        <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.72</span>,
                        <span class="kw">linetype</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span>),
                        <span class="kw">title</span>  <span class="kw">=</span>  <span class="st">'Kaplan-Meier of OS with standard distribution overlays'</span>,
                        <span class="kw">legend.title</span> <span class="kw">=</span> <span class="st">''</span>,
                        <span class="kw">legend.labs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"KM"</span>),
                        <span class="kw">surv.median.line</span> <span class="kw">=</span> <span class="st">'hv'</span>,
                        <span class="kw">palette</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="kw">max</span><span class="kw">=</span><span class="fl">30</span>)),
                        <span class="kw">risk.table.y.text.col</span> <span class="kw">=</span> <span class="no">F</span>
)


<span class="no">plot.PFS.B</span>$<span class="no">plot</span> <span class="kw">&lt;-</span> <span class="no">plot.PFS.B</span>$<span class="no">plot</span> +
  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">time</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">Ref</span>,
                <span class="kw">colour</span> <span class="kw">=</span> <span class="no">Dist</span>,
                <span class="kw">linetype</span> <span class="kw">=</span> <span class="no">Dist</span>),
            <span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.72</span>,
            <span class="kw">data</span> <span class="kw">=</span> <span class="no">curvefits_df_PFS</span>) +
  <span class="fu">scale_color_manual</span>(<span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">blue</span>, <span class="no">pink</span>, <span class="no">Dyellow</span>, <span class="no">orange</span>))
<span class="co">#&gt; Scale for 'colour' is already present. Adding another scale for 'colour',</span>
<span class="co">#&gt; which will replace the existing scale.</span>

<span class="no">plot.PFS.B</span></pre></body></html></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
</div>
<div id="adressing-uncertainty---bootstrapping" class="section level1">
<h1 class="hasAnchor">
<a href="#adressing-uncertainty---bootstrapping" class="anchor"></a>Adressing uncertainty - Bootstrapping</h1>
<p>Bootstrapping has been used to estimate the uncertainty of the parameters from the survival models. Boostrapping is used for two reasons motivated by intent of this package to support further modeling in excel. 1. To simplify and accelerate calculations in excel while maintaining correlations between parameters (as is commonly done for NMA) 2. To maintain correlations across multiple endpoints (see separate vignette for details)</p>
<p>Bootstrapping involves:</p>
<ol style="list-style-type: decimal">
<li>Sampling, with replacement, from all patients</li>
<li>Estimating all specified parametric survival models</li>
</ol>
<p>This procedure is repeated multiple times to obtain a distribution of parameters. For this example, bootstrap estimates of the parameters were calculated using the <tt>boot</tt> package. An argument for the <tt>boot</tt> function is <tt>statistic</tt> which is a function which when applied to data returns a vector containing the statistic(s) of interest. The <tt>bootPSM</tt> function in the <tt>flexsurvPlus</tt> package can be used for this purpose.</p>
<p>The inputs for the <tt>bootPSM</tt> function are identical to the <tt>runPSM</tt> function, however there is one additional argument: *<tt>i</tt> - Index used to select a sample within <tt>boot</tt></p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2358</span>)
<span class="co"># for speed and illustration only 4 models are selected for bootstrapping - all could be included</span>
<span class="no">n.sim</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">PSM_bootstraps_PFS</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/boot/man/boot.html">boot</a></span>(
  <span class="kw">statistic</span> <span class="kw">=</span> <span class="no">bootPSM</span>, <span class="co"># bootstrap function</span>
  <span class="kw">R</span><span class="kw">=</span><span class="no">n.sim</span>, <span class="co"># number of bootstrap samples</span>
  <span class="kw">data</span><span class="kw">=</span><span class="no">PFS_data</span>,
  <span class="kw">time_var</span><span class="kw">=</span><span class="st">"PFS_days"</span>,
  <span class="kw">event_var</span><span class="kw">=</span><span class="st">"PFS_event"</span>,
  <span class="kw">model.type</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Common shape"</span>, <span class="st">"Separate"</span>),
  <span class="kw">distr</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'weibull'</span>, <span class="st">'gamma'</span>),
  <span class="kw">strata_var</span> <span class="kw">=</span> <span class="st">"ARMCD"</span>,
  <span class="kw">int_name</span> <span class="kw">=</span> <span class="st">"B"</span>,
  <span class="kw">ref_name</span> <span class="kw">=</span> <span class="st">"A"</span>
)</pre></body></html></div>
<p>To simplify the post processing of the bootstrap samples a function  is provided that does some manipulations. This returns a tibble similar to the  one that is returned by . SampleID identified the bootstrap sample. SampleID of 0 are the parameters for the original data.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">PSM_bootstrap_PFS_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/bootPSMtidy.html">bootPSMtidy</a></span>(<span class="no">PSM_bootstraps_PFS</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">PSM_bootstrap_PFS_data</span>)
<span class="co">#&gt; # A tibble: 6 x 14</span>
<span class="co">#&gt;   SampleID Model Reference_name Intervention_na… weibull.scale.i…</span>
<span class="co">#&gt;      &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;                       &lt;dbl&gt;</span>
<span class="co">#&gt; 1        0 Comm… A              B                            437.</span>
<span class="co">#&gt; 2        0 Sepe… A              B                            437.</span>
<span class="co">#&gt; 3        1 Comm… A              B                            454.</span>
<span class="co">#&gt; 4        1 Sepe… A              B                            453.</span>
<span class="co">#&gt; 5        2 Comm… A              B                            453.</span>
<span class="co">#&gt; 6        2 Sepe… A              B                            455.</span>
<span class="co">#&gt; # … with 9 more variables: weibull.scale.ref &lt;dbl&gt;, weibull.shape.int &lt;dbl&gt;,</span>
<span class="co">#&gt; #   weibull.shape.ref &lt;dbl&gt;, weibull.scale.TE &lt;dbl&gt;, gamma.rate.int &lt;dbl&gt;,</span>
<span class="co">#&gt; #   gamma.rate.ref &lt;dbl&gt;, gamma.shape.int &lt;dbl&gt;, gamma.shape.ref &lt;dbl&gt;,</span>
<span class="co">#&gt; #   gamma.rate.TE &lt;dbl&gt;</span></pre></body></html></div>
</div>
<div id="estimating-quantities-from-the-sample" class="section level1">
<h1 class="hasAnchor">
<a href="#estimating-quantities-from-the-sample" class="anchor"></a>Estimating quantities from the sample</h1>
<p>As the <tt>flexsurv</tt> parameterisations are used any quantity of interest can be simply calculated for all models and samples through use of the flexsurv functions such as the extrapolated means via flexsurv::mean_weibull.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">estimated_deltamean</span> <span class="kw">&lt;-</span> <span class="no">PSM_bootstrap_PFS_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span>(<span class="no">SampleID</span>, <span class="no">Model</span>,
            <span class="kw">Weibull.Mean.ref</span> <span class="kw">=</span> <span class="kw pkg">flexsurv</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/means.html">mean_weibull</a></span>(<span class="kw">shape</span> <span class="kw">=</span> <span class="no">weibull.shape.ref</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="no">weibull.scale.ref</span>),
            <span class="kw">Weibull.Mean.int</span> <span class="kw">=</span> <span class="kw pkg">flexsurv</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/flexsurv/man/means.html">mean_weibull</a></span>(<span class="kw">shape</span> <span class="kw">=</span> <span class="no">weibull.shape.int</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="no">weibull.scale.int</span>),
            <span class="kw">Weibull.Mean.delta</span> <span class="kw">=</span> <span class="no">Weibull.Mean.int</span> - <span class="no">Weibull.Mean.ref</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">estimated_deltamean</span>)
<span class="co">#&gt; # A tibble: 6 x 5</span>
<span class="co">#&gt;   SampleID Model        Weibull.Mean.ref Weibull.Mean.int Weibull.Mean.delta</span>
<span class="co">#&gt;      &lt;int&gt; &lt;chr&gt;                   &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt; 1        0 Common shape             206.             399.               193.</span>
<span class="co">#&gt; 2        0 Seperate                 206.             399.               193.</span>
<span class="co">#&gt; 3        1 Common shape             210.             414.               204.</span>
<span class="co">#&gt; 4        1 Seperate                 209.             409.               200.</span>
<span class="co">#&gt; 5        2 Common shape             233.             419.               186.</span>
<span class="co">#&gt; 6        2 Seperate                 233.             425.               192.</span>

<span class="no">estimated_deltamean</span> <span class="kw">%&gt;%</span>
  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">Weibull.Mean.delta</span>)) +
  <span class="fu">geom_density</span>()</pre></body></html></div>
<p><img src="Fitting_models_in_R_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="outputing-parameters-to-excel" class="section level1">
<h1 class="hasAnchor">
<a href="#outputing-parameters-to-excel" class="anchor"></a>Outputing parameters to excel</h1>
<p>The primary use of the bootstrap samples is to be used in probabilistic sensitivity analyses in economic models.</p>
<p>Once all the models have been fit and bootstrap samples estimated they can be output to excel. By selecting SampleID = 0 the estimates for the original data are returned. To run PSA in excel only a random number between 1 and the number of samples needs to be generated.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r">
<span class="co"># Add meta data to include details of analysis</span>
<span class="no">parameters_PFS</span> <span class="kw">&lt;-</span> <span class="no">PSM_bootstrap_PFS_data</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Study_name</span> <span class="kw">=</span> <span class="st">"Study ABC"</span>,
         <span class="kw">Datacut</span> <span class="kw">=</span> <span class="st">"Final"</span>,
         <span class="kw">Population</span> <span class="kw">=</span> <span class="st">"ITT"</span>,
         <span class="kw">Endpoint</span> <span class="kw">=</span> <span class="st">"PFS"</span>)

<span class="co">#write.csv(parameters_PFS, "params_for_model.csv")</span></pre></body></html></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-latimer2011nice">
<p>[1] Latimer N. NICE dsu technical support document 14: Survival analysis for economic evaluations alongside clinical trials-extrapolation with patient-level data. Sheffield: Report by the Decision Support Unit 2011;2013.</p>
</div>
<div id="ref-rutherford2020nice">
<p>[2] Rutherford MJ, Lambert PC, Sweeting MJ, Pennington B, Crowther MJ, Abrams KR, et al. NICE dsu technical support document 21: Flexible methods for survival analysis 2020.</p>
</div>
<div id="ref-cadth2020">
<p>[3] CADTH. Procedures for cadth drug reimbursement reviews 2020.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iain Bennett, Jo Gregory, Sarah Smith, Richard Birnie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
